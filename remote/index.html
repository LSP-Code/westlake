<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Westlake Remote // v2.0</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@200;300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root { 
            --bg: #030303; --glass: rgba(255, 255, 255, 0.05); --glass-border: rgba(255, 255, 255, 0.1);
            --primary: #d2e7d6; --accent: #88998b; --error: #ffb4ab; --warning: #fce99a;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; font-family: 'Inter', sans-serif; }
        body { 
            background: var(--bg); color: #e2e3dd; height: 100vh; display: flex; flex-direction: column; 
            padding: 30px 20px; overflow: hidden;
        }

        /* HEADER */
        header { margin-bottom: 30px; }
        header h1 { font-size: 1.8vh; font-weight: 400; letter-spacing: 5px; color: var(--primary); text-transform: uppercase; }
        header p { font-size: 1vh; opacity: 0.4; letter-spacing: 2px; margin-top: 5px; }

        /* SECTIONS */
        .section { margin-bottom: 25px; }
        .label { font-size: 1vh; font-weight: 600; color: var(--accent); margin-bottom: 12px; letter-spacing: 0.2vh; text-transform: uppercase; display: block; }

        /* GLASS INPUT */
        input { 
            width: 100%; background: var(--glass); border: 1px solid var(--glass-border); color: #fff; 
            padding: 20px; border-radius: 18px; font-size: 16px; font-weight: 300; margin-bottom: 12px; outline: none;
            backdrop-filter: blur(10px);
        }

        /* BUTTONS */
        .btn { 
            width: 100%; padding: 18px; border-radius: 18px; border: 1px solid var(--glass-border); 
            font-weight: 500; font-size: 14px; cursor: pointer; transition: 0.2s; background: var(--glass); color: #fff;
        }
        .btn:active { transform: scale(0.96); background: rgba(255,255,255,0.15); }
        .btn-main { background: var(--primary); color: #000; border: none; font-weight: 600; }
        .btn-sec { background: transparent; border-color: var(--glass-border); color: #fff; font-weight: 300; }

        /* 7 EMERGENCY GRID */
        .emer-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .btn-e { 
            background: rgba(255,180,171,0.03); border: 1px solid rgba(255,180,171,0.15); 
            color: var(--error); padding: 15px; border-radius: 15px; font-size: 12px; font-weight: 500; 
            text-transform: uppercase; display: flex; align-items: center; justify-content: center; gap: 8px;
        }
        .btn-cancel { 
            grid-column: span 2; background: #fff; color: #000; font-weight: 700; border: none; margin-top: 5px;
        }

        /* DISHES SYNC */
        .dish-box { 
            background: var(--glass); border: 1px solid var(--glass-border); padding: 15px 20px; 
            border-radius: 18px; display: flex; justify-content: space-between; align-items: center;
        }
        #dish-display { font-size: 20px; font-weight: 200; color: var(--primary); }
    </style>
</head>
<body>

    <header>
        <h1>Westlake Remote</h1>
        <p>SECURE TERMINAL v2.0</p>
    </header>

    <div class="section">
        <span class="label">System Announcement</span>
        <input type="text" id="announceInput" placeholder="Enter message for TV...">
        <button class="btn btn-main" onclick="sendRemoteAlert()">EXECUTE BROADCAST</button>
    </div>

    <div class="section">
        <span class="label">Emergency Console</span>
        <div class="emer-grid">
            <button class="btn-e" onclick="triggerRemoteSiren('POLICE')">Police</button>
            <button class="btn-e" onclick="triggerRemoteSiren('FIRE')">Fire</button>
            <button class="btn-e" onclick="triggerRemoteSiren('MEDICAL')">Medical</button>
            <button class="btn-e" onclick="triggerRemoteSiren('INTRUDER')">Intruder</button>
            <button class="btn-e" style="color:var(--warning); border-color:rgba(252,233,154,0.1)" onclick="triggerRemoteSiren('WEATHER')">Weather</button>
            <button class="btn-e" onclick="triggerRemoteSiren('AMBER')">Amber</button>
            <button class="btn-e" onclick="triggerRemoteSiren('LOCKDOWN')">Lockdown</button>
            <button class="btn btn-cancel" onclick="cancelEmergency()">ðŸ›‘ ALL CLEAR</button>
        </div>
    </div>

    <div class="section">
        <span class="label">Chore Rotation</span>
        <div class="dish-box">
            <span id="dish-display">---</span>
            <button class="btn btn-sec" style="width: auto; padding: 10px 20px;" onclick="rotateDishes()">Next</button>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, doc, setDoc, addDoc, collection, serverTimestamp, getDoc, updateDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDn3fqrdVcRnvkiX7t6TPJWrngXSrM_1p4",
            projectId: "my-a-ab8f3",
            appId: "1:65984042323:web:04a6ebadc4eb29d52c3da6"
        };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // 1. Send Text Announcement
        window.sendRemoteAlert = async () => {
            const input = document.getElementById('announceInput');
            if(!input.value.trim()) return;
            await addDoc(collection(db, "houseInfo"), {
                title: "REMOTE ALERT",
                text: input.value,
                createdAt: serverTimestamp()
            });
            input.value = "";
        };

        // 2. 7-Option Emergency Trigger
        window.triggerRemoteSiren = async (type) => {
            await setDoc(doc(db, "system_triggers", "current_alert"), {
                type: type,
                active: true,
                cancel: false,
                timestamp: Date.now()
            });
        };

        // 3. Cancel Everything
        window.cancelEmergency = async () => {
            await setDoc(doc(db, "system_triggers", "current_alert"), {
                active: false,
                cancel: true,
                timestamp: Date.now()
            });
        };

        // 4. Real-time Dish Sync
        const rota = ["BRIAN", "MALAKI", "LOGAN"];
        onSnapshot(doc(db, "settings", "dishes"), (snap) => {
            if(snap.exists()) {
                document.getElementById('dish-display').innerText = rota[snap.data().index];
            }
        });

        window.rotateDishes = async () => {
            const ref = doc(db, "settings", "dishes");
            const snap = await getDoc(ref);
            if(snap.exists()) {
                await updateDoc(ref, { index: (snap.data().index + 1) % 3 });
            }
        };
    </script>
</body>
</html>
