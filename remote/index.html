<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Westlake Remote // v1.0</title>
    <style>
        :root { 
            --bg: #000000; --surface: #141614; --primary: #d2e7d6; 
            --on-primary: #1e3623; --error: #ffb4ab; --warning: #fce99a; 
        }
        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; 
            background: var(--bg); color: white; height: 100vh; display: flex; flex-direction: column; padding: 20px;
        }

        .header { margin-bottom: 30px; border-bottom: 1px solid #333; padding-bottom: 10px; }
        .header h1 { font-size: 18px; letter-spacing: 2px; color: var(--primary); }

        .section { margin-bottom: 25px; }
        .label { font-size: 11px; font-weight: 700; color: var(--primary); opacity: 0.6; text-transform: uppercase; margin-bottom: 8px; display: block; }

        /* Input & Main Button */
        input { 
            width: 100%; background: #1c1c1e; border: 1px solid #333; color: white; 
            padding: 18px; border-radius: 12px; font-size: 16px; margin-bottom: 12px; outline: none;
        }
        input:focus { border-color: var(--primary); }

        .btn { 
            width: 100%; padding: 18px; border-radius: 12px; border: none; font-weight: 700; 
            font-size: 14px; cursor: pointer; transition: transform 0.1s;
        }
        .btn:active { transform: scale(0.97); }
        .btn-main { background: var(--primary); color: var(--on-primary); }

        /* Emergency Grid */
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .btn-emer { 
            background: #2a0000; color: var(--error); border: 1px solid rgba(255,180,171,0.2); 
            height: 90px; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 8px;
        }
        .btn-weather { background: #2a2300; color: var(--warning); border-color: rgba(252,233,154,0.2); }

        /* Secondary Actions */
        .btn-sec { background: #2c2c2e; color: white; margin-top: 10px; }
    </style>
</head>
<body>

    <div class="header">
        <h1>WESTLAKE REMOTE</h1>
    </div>

    <div class="section">
        <span class="label">System Announcement</span>
        <input type="text" id="announceInput" placeholder="Type to speak on TV...">
        <button class="btn btn-main" onclick="sendRemoteAlert()">EXECUTE BROADCAST</button>
    </div>

    <div class="section">
        <span class="label">Household Management</span>
        <button class="btn btn-sec" onclick="rotateDishes()">NEXT DISH ROTATION</button>
    </div>

    <div class="section">
        <span class="label">Emergency Triggers</span>
        <div class="grid">
            <button class="btn btn-emer" onclick="triggerRemoteSiren('POLICE')">
                <span style="font-size: 24px;">üö®</span> POLICE
            </button>
            <button class="btn btn-emer" onclick="triggerRemoteSiren('FIRE')">
                <span style="font-size: 24px;">üî•</span> FIRE
            </button>
            <button class="btn btn-emer" onclick="triggerRemoteSiren('INTRUDER')">
                <span style="font-size: 24px;">üë§</span> INTRUDER
            </button>
            <button class="btn btn-emer btn-weather" onclick="triggerRemoteSiren('WEATHER')">
                <span style="font-size: 24px;">üå™Ô∏è</span> WEATHER
            </button>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, doc, setDoc, addDoc, collection, serverTimestamp, getDoc, updateDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDn3fqrdVcRnvkiX7t6TPJWrngXSrM_1p4",
            projectId: "my-a-ab8f3",
            appId: "1:65984042323:web:04a6ebadc4eb29d52c3da6"
        };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // 1. Send Text Announcement to TV
        window.sendRemoteAlert = async () => {
            const input = document.getElementById('announceInput');
            if(input.value.trim() === "") return;

            await addDoc(collection(db, "houseInfo"), {
                title: "REMOTE ALERT",
                text: input.value.toUpperCase(),
                createdAt: serverTimestamp()
            });
            input.value = "";
            alert("Broadcast Sent");
        };

        // 2. Trigger Siren on TV
        window.triggerRemoteSiren = async (type) => {
            await setDoc(doc(db, "system_triggers", "current_alert"), {
                type: type,
                active: true,
                timestamp: Date.now()
            });
        };

        // 3. Rotate Dishes from Phone
        window.rotateDishes = async () => {
            const ref = doc(db, "settings", "dishes");
            const snap = await getDoc(ref);
            if(snap.exists()) {
                const newIdx = (snap.data().index + 1) % 3;
                await updateDoc(ref, { index: newIdx });
                alert("Rotation Updated");
            }
        };
    </script>
</body>
</html>
